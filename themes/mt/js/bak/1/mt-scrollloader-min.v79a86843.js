M.add("mt-scrollloader",function(t){function e(){e.superclass.constructor.apply(this,arguments)}var n=M.window,i=t.mt.util,r="enter_view",a=300,o=t.config["mt-scrollloader"]||{};e.NAME="trackedsport",e.ATTRS={node:{value:null,setter:function(e){return t.one(e)},writeOnce:!0},margin:{value:[0,0,0,0],getter:function(t){return t=[].concat(t),t[0]=t[0]?t[0]:0,t[1]=void 0===t[1]?t[0]:t[1],t[2]=void 0===t[2]?t[0]:t[2],t[3]=void 0===t[3]?t[1]:t[3],t}},region:{value:null,getter:function(t){var e=this.get("margin"),i=this._ts||0,r=n.now();return t=t||this._region,t?r>a+i&&(this._ts=r,t=this._refreshRegion()):t=this._refreshRegion(),t.left-=e[0],t.top-=e[1],t.right+=e[2],t.bottom+=e[3],t}},target:{value:null}},t.extend(e,t.Base,{initializer:function(){this._refreshRegion(),this.publish(r)},_refreshRegion:function(){var t=this.get("node");return t?(this._region=t.get("region"),this._region):this.get("target")},check:function(){var t=this;t._enterTimer||(t._enterTimer=n.setFrameout(function(){t.inTarget()&&t.fire(r),t._enterTimer=null},20))},inTarget:function(){var t=this.get("region"),e=this.get("target");return t.top<e.bottom&&t.bottom>e.top&&t.left<e.right&&t.right>e.left}});var l=function(){function t(){var t=n.get("innerWidth"),e=n.get("innerHeight"),r=n.get("pageXOffset"),a=n.get("pageYOffset");o={left:r,right:r+t,top:a,bottom:a+e,width:t,height:e},n.resize(function(){o.width=n.get("innerWidth"),o.height=n.get("innerHeight"),o.right=o.left+o.width,o.bottom=o.top+o.height,i()}),n.scroll(function(){o.left=n.get("pageXOffset"),o.top=n.get("pageYOffset"),o.right=o.left+o.width,o.bottom=o.top+o.height,i()}),s=!0}function i(){for(var t=a.length-1;t>=0;t--)a[t].check()}var a=[],o=null,s=!1;return{onceenter:function(n,i,g){s||t();var c=new e({node:n,margin:g,target:o});return c.inTarget()?i.call(c):(a.push(c),c.on(r,function(){i.call(this),l.remove(c)})),c},remove:function(t){for(var e=a.length-1;e>=0;e--)if(t===a[e])return void a.splice(e,1)}}}();t.namespace("mt.ScrollLoader"),t.mt.ScrollLoader={Image:{LAZY_SRC:"data-src",init:function(e){e=e||{};var n=this,i=e.lazyClass||o.jsLazyClass,r=e.ndContainer||"body";i&&t.all(r).each(function(t){t.all("."+i).each(function(t){l.onceenter(t,function(){n.load(t)},e.offset),t.removeClass(i)})})},loadImmediately:function(e){var n=this;t.all(e).each(function(t){t.hasAttribute(n.LAZY_SRC)?n.load(t):t.all("["+n.LAZY_SRC+"]").each(function(t){n.load(t)})})},load:function(t){var e=this,n=t.getAttribute(e.LAZY_SRC);n&&"img"===t.get("tagName").toLowerCase()&&(n=e._getWebpSrc(t,n),o.cssLazyClass&&t.on("load",function(){t.removeClass(o.cssLazyClass)}),t.setAttribute("src",n),t.removeAttribute(e.LAZY_SRC))},_getWebpSrc:function(t,e){var n="J-webp",i=!1,r="";return window.localStorage&&"object"==typeof localStorage&&(i="available"===localStorage.getItem("webpa")&&t.hasClass(n)),r=i?e+".webp":e}},BigRender:{CLS_TEXTAREA:"J-bigrender-data",ATT_TEXTAREA:"data-bigrender-params",init:function(){function e(e){var r=i.getConfig(e),a=r.target&&t.one(r.target)||e.ancestor(),o=+r.offset||0;if(o+n.get("pageYOffset")+n.get("innerHeight")>a.getY())i.load(e,r);else var l=n.scrollDown(function(){o+n.get("pageYOffset")+n.get("innerHeight")>a.getY()&&(i.load(e,r),l.detach(),l=null)},6);e.removeClass(i.CLS_TEXTAREA)}var i=this,r="J-lazy-render";t.all("."+r).each(function(t){t.hasClass(i.CLS_TEXTAREA)?e(t):t.all("."+i.CLS_TEXTAREA).each(e),t.removeClass(r)})},loadImmediately:function(e){var n=this;t.all(e).each(function(t){t.hasClass(n.CLS_TEXTAREA)?n.load(t):t.all("."+n.CLS_TEXTAREA).each(function(t){n.load(t)})})},getConfig:function(t){if(!t.hasAttribute(this.ATT_TEXTAREA))return{};var e=t.getAttribute(this.ATT_TEXTAREA);return i.decodeJSON(e)||{}},load:function(e,n){if(e&&!e.hasClass("br-rendered")){e.addClass("br-rendered"),n=n||this.getConfig(e);var i=t.Node.create("<div>"+e.get("value")+"</div>"),r=i.all("script").remove(),a=n.target&&t.one(n.target);a?a.appendChild(i.getHTML()):e.insertBefore(i.getHTML(),e),e.removeClass(this.CLS_TEXTAREA),r.each(function(t){window.eval.call(window,t.getHTML())})}}}},M._autoinit=M._autoinit||[],M._autoinit.push(function(e){t.mt.ScrollLoader.Image.init({ndContainer:e})})},"1.0.0",{requires:["mt-base","mt-window","base-base","node"]});