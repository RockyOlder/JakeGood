M.add("mt-viewporttracker",function(t){function e(){e.superclass.constructor.apply(this,arguments)}function i(){function t(){for(var t=g.length-1;t>=0;t--)g[t].check()}var e=r.get("innerWidth"),i=r.get("innerHeight"),n=r.get("pageXOffset"),o=r.get("pageYOffset");h={left:n,right:n+e,top:o,bottom:o+i,width:e,height:i},r.resize(function(){h.width=r.get("innerWidth"),h.height=r.get("innerHeight"),h.right=h.left+h.width,h.bottom=h.top+h.height,t()}),r.scroll(function(){h.left=r.get("pageXOffset"),h.top=r.get("pageYOffset"),h.right=h.left+h.width,h.bottom=h.top+h.height,t()}),a=!0}var r=M.window,n="enter_view",o=300;e.NAME="trackedsport",e.ATTRS={node:{value:null,setter:function(e){return t.one(e)},writeOnce:!0},margin:{value:[0,0,0,0],getter:function(t){return t=[].concat(t),t[0]=t[0]?t[0]:0,t[1]=void 0===t[1]?t[0]:t[1],t[2]=void 0===t[2]?t[0]:t[2],t[3]=void 0===t[3]?t[1]:t[3],t}},region:{value:null,getter:function(t){var e=this.get("margin"),i=this._ts||0,n=r.now();return t=t||this._region,t?n>o+i&&(this._ts=n,t=this._refreshRegion()):t=this._refreshRegion(),t.left-=e[0],t.top-=e[1],t.right+=e[2],t.bottom+=e[3],t}},target:{value:null}},t.extend(e,t.Base,{initializer:function(){this._refreshRegion(),this.publish(n)},_refreshRegion:function(){var t=this.get("node");return t?(this._region=t.get("region"),this._region):this.get("target")},check:function(){var t=this;t._enterTimer||(t._enterTimer=r.setFrameout(function(){t.inTarget()&&t.fire(n),t._enterTimer=null},20))},inTarget:function(){var t=this.get("region"),e=this.get("target");return t.top<e.bottom&&t.bottom>e.top&&t.left<e.right&&t.right>e.left}});var g=[],h=null,a=!1;t.namespace("mt.ViewportTracker"),t.mt.ViewportTracker={onceenter:function(t,r,o){var s=this;a||i();var f=new e({node:t,margin:o,target:h});return f.inTarget()?r.call(f):(g.push(f),f.on(n,function(){r.call(this),s.remove(f)})),f},remove:function(t){for(var e=g.length-1;e>=0;e--)if(t===g[e])return void g.splice(e,1)}}},"1.0.0",{requires:["mt-window","base-base","node"]});