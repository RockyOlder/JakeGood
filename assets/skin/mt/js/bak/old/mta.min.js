!function(e,t){function n(){var n="-",r=a.encode,i=e.screen,o=e.navigator,s=this._getViewport();this.screen=i?i.width+"x"+i.height:n,this.viewport=s.width+"x"+s.height,this.charset=r(t.characterSet?t.characterSet:t.charset?t.charset:n),this.language=(o&&o.language?o.language:o&&o.browserLanguage?o.browserLanguage:n).toLowerCase(),this.javaEnabled=o&&o.javaEnabled()?1:0,this.isFirstVisit=!1,this.setCookie()}function r(e){this.url=e}function i(e){this._config=a.merge({sampleRate:100,useCombo:!0,beacon:t.location.protocol+"//frep.meituan.net/_.gif"},e||{}),this._client=new n,this._beacon=new r(this._config.beacon),this._queue=[],this._timer=null,this.app=null,this.tags={},this.visitorCode=a.random()}var o=Object.prototype.hasOwnProperty,a={hash:function(e){var t,n=1,r=0;if(e)for(n=0,t=e.length-1;t>=0;t--)r=e.charCodeAt(t),n=(n<<6&268435455)+r+(r<<14),r=266338304&n,n=0!==r?n^r>>21:n;return n},random:function(){return Math.round(2147483647*Math.random())},stringify:function(e){if("undefined"!=typeof JSON&&JSON.stringify)return JSON.stringify(e);var t=typeof e;switch(t){case"string":return'"'+e+'"';case"boolean":case"number":return String(e);case"object":if(null===e)return"null";var n=!1,r="";for(var i in e)if(o.call(e,i)){var s=""+i,c=a.stringify(e[i]);c.length&&(n?r+=",":n=!0,r+=e instanceof Array?c:'"'+s+'":'+c)}return e instanceof Array?"["+r+"]":"{"+r+"}";default:return""}},debug:function(e,t){"undefined"!=typeof console&&console.log&&(t&&console.warn?console.warn(e):console.log(e))},encode:function(e,t){return encodeURIComponent instanceof Function?t?encodeURI(e):encodeURIComponent(e):escape(e)},decode:function(e,t){var n;if(e=e.split("+").join(" "),decodeURIComponent instanceof Function)try{n=t?decodeURI(e):decodeURIComponent(e)}catch(r){n=unescape(e)}else n=unescape(e);return n},merge:function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);return e},buildQueryString:function(e){var t,n=a.encode,r=[];for(t in e)if(o.call(e,t)){var i="object"==typeof e[t]?a.stringify(e[t]):e[t];r.push(n(t)+"="+n(i))}return r.join("&")},addEventListener:function(t,n,r){return e.addEventListener?e.addEventListener(t,n,r):e.attachEvent?e.attachEvent("on"+t,n):void 0},onload:function(e){"complete"===t.readyState?e():a.addEventListener("load",e,!1)},domready:function(e){"interactive"===t.readyState?e():t.addEventListener?t.addEventListener("DOMContentLoaded",e,!1):t.attachEvent&&t.attachEvent("onreadystatechange",e)},onunload:function(e){a.addEventListener("unload",e,!1),a.addEventListener("beforeunload",e,!1)},now:function(){return(new Date).getTime()}},s={get:function(e){for(var n=t.cookie,r=e+"=",i=r.length,o=n.length,a=0;o>a;){var s=a+i;if(n.substring(a,s)===r)return this._getValue(s);if(a=n.indexOf(" ",a)+1,0===a)break}return""},set:function(e,n,r,i,o,a){o=o?o:this._getDomain(),t.cookie=e+"="+encodeURIComponent(n)+(r?"; expires="+r:"")+(i?"; path="+i:"; path=/")+(o?"; domain="+o:"")+(a?"; secure":"")},getExpire:function(e,t,n){var r=new Date;return"number"==typeof e&&"number"==typeof t&&"number"==typeof t?(r.setDate(r.getDate()+parseInt(e,10)),r.setHours(r.getHours()+parseInt(t,10)),r.setMinutes(r.getMinutes()+parseInt(n,10)),r.toGMTString()):void 0},_getValue:function(e){var n=t.cookie,r=n.indexOf(";",e);return-1===r&&(r=n.length),decodeURIComponent(n.substring(e,r))},_getDomain:function(){var e=t.domain;return"undefined"!=typeof M&&M.DOMAIN_HOST&&(e="."+M.DOMAIN_HOST),"www."===e.substring(0,4)&&(e=e.substring(4)),e}},c="__mta";n.prototype={setCookie:function(){var e=s.get(c),t=s.getExpire(720,0,0),n=a.now();if(e)e=e.split("."),e[2]=e[3],e[3]=n,e[4]=parseInt(e[4],10)+1,s.set(c,e.join("."),t),this.uuid=e[0];else{var r=this._hashInfo(),i=n,o=n,u=n,d=1;e=[r,i,o,u,d].join("."),s.set(c,e,t),this.isFirstVisit=!0,this.uuid=r}},getInfo:function(){return{sr:this.screen,vp:this.viewport,csz:t.cookie?t.cookie.length:0}},_hashInfo:function(){var n=e.navigator,r=e.history.length;n=n.appName+n.version+this.language+n.platform+n.userAgent+this.javaEnabled+this.screen+(t.cookie?t.cookie:"")+(t.referrer?t.referrer:"");for(var i=n.length;r>0;)n+=r--^i++;return a.hash(n)},_getViewport:function(){return null!==e.innerWidth?{width:e.innerWidth,height:e.innerHeight}:"CSS1Compat"===t.compatMode?{width:t.documentElement.clientWidth,height:t.documentElement.clientHeight}:{width:t.body.clientWidth,height:t.body.clientWidth}}},r.MAX_URL_LENGTH=4096,r.prototype={send:function(e,t){e.version=i.VERSION;var n=a.buildQueryString(e);if(n.length)if(n.length<=r.MAX_URL_LENGTH)this._sendByScript(n,t);else{var o={app:"performance",type:"combo",data:[{type:"counter",category:"mtajs",data:{lengthError:1}},{type:"timer",category:"mtajs",data:{beaconLength:n.length}}]};this._sendByScript(a.buildQueryString(o),t)}},_sendByScript:function(e,n){var r=t.createElement("script");r.type="text/javascript",r.async=!0,r.src=this.url+"?"+e,r.onload=function(){r.onload=null,n&&n()};var i=t.getElementsByTagName("script")[0];i.parentNode.insertBefore(r,i)}};var u=100;i.VERSION="0.1.16",i.Plugins={},i.addPlugin=function(e,t){if("function"!=typeof t.data)throw new Error("cannot add plugin: "+e);i.Plugins[e]=t},i.prototype={push:function(){for(var e=Array.prototype.slice,t=0,n=0,r=arguments.length;r>n;n++)try{var i=arguments[n];if("function"==typeof i)arguments[n](this);else{i=e.call(i,0);var o=i[0];this[o].apply(this,i.slice(1))}}catch(a){t++}return t},create:function(e,t){this.app=e,this._config=a.merge(this._config,t||{})},config:function(e,t){switch(e){case"sampleRate":"number"==typeof t&&(this._config.sampleRate=t);break;case"beaconImage":t&&(this._config.beacon=t,this._beacon=new r(this._config.beacon))}},tag:function(e,t){"undefined"!=typeof t?this.tags[e]=t:"undefined"!=typeof this.tags[e]&&delete this.tags[e]},send:function(t,n,r){if(t){var o=i.Plugins[t],a=!1;if(o?(n=o.data(),n&&(a=!0,this._push({category:t,type:o.type||"timer",data:n}))):"undefined"!=typeof n&&(a=!0,this._push({category:t,type:r||"timer",data:n})),a){var s=this;this._timer&&(e.clearTimeout(this._timer),this._timer=null),this._timer=e.setTimeout(function(){s._send.call(s)},u)}}},timing:function(e,t){this.send(e,t,"timer")},count:function(e,t){this.send(e,t,"counter")},gauge:function(e,t){this.send(e,t,"gauge")},_push:function(e){var t=a.merge,n=this._client.getInfo(),i=t({app:this.app,type:"combo"},e);i=t(i,this.tags),i=t(i,n),i.data=this._queue.concat(e),a.buildQueryString(i).length>r.MAX_URL_LENGTH&&this._send(),this._queue.push(e)},_send:function(e,t){if(this.app&&this._isSample(t)){var n=a.merge,r=this._config.useCombo,i=this._client.getInfo(),o=n({app:this.app,type:"combo"},e);if(o=n(o,this.tags),o=n(o,i),e)return this._beacon.send(o);if(this._queue.length){if(r)1===this._queue.length?(o=n(o,this._queue[0]),this._beacon.send(o)):(o.data=this._queue,this._beacon.send(o));else for(var s=0,c=this._queue.length;c>s;s++)this._beacon.send(this._queue[s]);this._queue=[]}}},_isSample:function(e){return e=e>0?e:this._config.sampleRate,this.visitorCode%1e4<100*e}},i.addPlugin("cdn",{type:"timer",data:function(){if("object"==typeof M&&M.subresources&&M.subresources.names&&d){e.SubResoucesTiming=d;var t=M.subresources.lastImage||"",n=M.subresources.firstImage||"",r=new d(M.subresources.names,t,n);if(!r.length)return;for(var i={},o=0,a=r.length;a>o;o++){var s=r[o];if(s.server){i[s.server]={};for(var c in s)s.hasOwnProperty(c)&&parseInt(s[c],10)>0&&(i[s.server][c]=s[c])}}return i}}}),i.addPlugin("page",{type:"timer",data:function(){var t=e,n=t.performance||t.mozPerformance||t.msPerformance||t.webkitPerformance;if(n){var r=n.timing,i={redirect:r.fetchStart-r.navigationStart,dns:r.domainLookupEnd-r.domainLookupStart,connect:r.connectEnd-r.connectStart,network:r.connectEnd-r.navigationStart,send:r.responseStart-r.requestStart,receive:r.responseEnd-r.responseStart,backend:r.responseEnd-r.requestStart,render:r.loadEventEnd-r.loadEventStart,dom:r.domComplete-r.domLoading,frontend:r.loadEventEnd-r.domLoading,load:r.loadEventEnd-r.navigationStart,ttfb:r.responseStart-r.navigationStart,domReady:r.domContentLoadedEventStart-r.navigationStart,interactive:r.domInteractive-r.navigationStart};if(r.msFirstPaint&&(i.firstPaint=r.msFirstPaint),t.chrome&&t.chrome.loadTimes){var o=t.chrome.loadTimes();i.firstPaint=Math.round(1e3*(o.firstPaintTime-o.startLoadTime))}return"undefined"!=typeof M&&M.TimeTracker&&M.TimeTracker.fst&&(i.firstScreen=M.TimeTracker.fst-r.navigationStart),i}}}),i.addPlugin("resource",{type:"timer",data:function(){if("object"==typeof M&&M.subresources&&M.subresources.names&&d){e.SubResoucesTiming=d;var t=M.subresources.lastImage||"",n=M.subresources.firstImage||"",r=new d(M.subresources.names,t,n);if(!r.length)return;for(var i={},o=0,a=r.length;a>o;o++){var s=r[o];if(s.id){i[s.id]={};for(var c in s)s.hasOwnProperty(c)&&parseInt(s[c],10)>0&&(i[s.id][c]=s[c])}}return i}}});var d;d=function(){function t(t,p,l){var m,v,y,b,_,S,E,w,M,I,L,T,k,O,R,j,C,q,P,x,A,N,U;if(e.performance&&e.performance.getEntries&&[].forEach&&[].indexOf){for(E=navigator.userAgent.indexOf(!0)?!0:!1,T=[].concat(t),I=0,M=0,R=[],O={},L=function(e,t){return O[e]&&O[t]&&-1!==O[e]&&-1!==O[t]?O[e]-O[t]:-1},U=e.performance.getEntries(),A=0,N=U.length;N>A&&(w=U[A],T.length);A++)S=T.indexOf(w.name),-1!==S&&(T.splice(S,1),k={},O={},u.forEach(function(e){var t;return(t=Math.max(w[e],0))?(O[e]=(t||-1).toFixed(0),O[e]):void 0}),m=L(o,g),b=L(i,o),v=L(n,r),C=L(d,n),j=L(h,d),P=L(f,h),y=0,E?O.fetchStart===O.requestStart&&O.requestStart===O.responseStart&&O.responseStart!==O.responseEnd&&(y=1):0!==O.domainLookupStart&&0===O.requestStart&&(y=1),q=c(w.name),_=s(w.initiatorType,w.name),x=null,(w.name===p||p&&p.push&&-1!==p.indexOf(w.name))&&(x=w.name,M=O[f]),l&&w.name===l&&(I=O[g]),k={start:O[g],duration:O[a],dc:y,server:q,type:w.initiatorType,id:_},x&&(k.url=x),~m&&(k.blocking=m),~b&&(k.dns=b),~v&&(k.connecting=v),~C&&(k.sending=C),~j&&(k.response=j),~P&&(k.transfer=P),R.push(k));return I&&M&&(k={start:I,duration:M-I,type:"items",id:"fsImg"},R.push(k)),R}}var n,r,i,o,a,s,c,u,d,f,h,g;return s=function(e,t){var n;return"img"===e?n=/logo/.test(t)?"logo":"content":"script"===e?/deps/.test(t)?n="deps":/mt-core/.test(t)&&(n="yui"):"link"===e&&(n=/common/.test(t)?"base":"widget"),n},c=function(e){var t;return t=/^https?:\/\/(\w+)(?:\.)/.exec(e),t[1]||""},g="startTime",o="domainLookupStart",i="domainLookupEnd",r="connectStart",n="connectEnd",d="requestStart",h="responseStart",f="responseEnd",a="duration",u=[g,r,n,o,i,d,h,f,a],t}(),a.onload(function(){if(e.MeituanAnalyticsObject){var t=Object.prototype.toString,n=new i,r=e[e.MeituanAnalyticsObject],o=r?r.q:[];r.q=n,o&&"[object Array]"===t.call(o)&&n.push.apply(n,o)}})}(window,document);