M.add("p-node-effect",function(e){function n(){this._running=0,n.superclass.constructor.apply(this,arguments)}var t=e.Node,i=e.Lang.isString,o=e.Lang.isNumber,a=e.Lang.isArray,s=e.Lang.isFunction,u=e.mt.UIUtil,r={slow:600,middle:400,fast:200},g={yellow:{from:"#FFF478",to:"#FFFFFF"}},d="backgroundColor",f="position",l="Effect.start",c="Effect.end";n.NAME="effectPlugin",n.NS="effect",n.ATTRS={},e.extend(n,e.Plugin.Base,{initializer:function(){var n=this,t=n.get("host");t instanceof e.Node&&(t.publish(l,{emitFacade:!0,defaultFn:function(){n._running++}}),t.publish(c,{emitFacade:!0,defaultFn:function(){n._running--}}))},destructor:function(){},fadeInSimple:function(n,t,i){var o,a=this,s=a.get("host");n=a._getSpeed(n),s.setStyle("opacity",0).show(),o=a._fade(s,1,n,t,i,{easing:e.Easing.easeIn}),a._run(o)},fadeIn:function(n,t,i){var o,a,s=this,r=s.get("host"),g=u.getDimensions(r),d=s._cloneLayout(r,"div");n=s._getSpeed(n),d.setStyles({height:0,display:"block"}),r.replace(d),a=s._fade(r,1,n,t,i,{easing:e.Easing.easeIn}),o=new e.Anim({node:d,to:{height:g.marginTop+g.offsetHeight+g.marginBottom},duration:.6*n,easing:e.Easing.easeIn}),o.on("end",function(){s._setPosition(r),r.setStyle("opacity",0).show(),d.replace(r)}),s._run(o,a)},fadeOutSimple:function(n,t,i,o){var a,u=this,r=u.get("host"),g=function(){r.hide(),s(i)&&i.call(r),n&&r.remove(!0)};t=u._getSpeed(t),a=u._fade(r,0,t,g,o,{easing:e.Easing.easeOut}),r.show(),u._run(a)},fadeOut:function(n,t,i,o){var a,r,g=this,d=g.get("host"),f=d.getStyle("opacity"),l=u.getDimensions(d),c=g._cloneLayout(d,"div");t=g._getSpeed(t),c.setStyles({height:l.marginTop+l.offsetHeight+l.marginBottom,display:"block"}),g._setPosition(d),r=g._fade(d,0,t,null,o,{easing:e.Easing.easeOut}),r.on("end",function(){d.replace(c)}),a=new e.Anim({node:c,to:{height:0},duration:.6*t,easing:e.Easing.easeOut}),a.on("end",function(){d.setStyles({display:"none",opacity:f}),c.replace(d),s(i)&&i.call(d),n&&d.destroy(!0)}),g._run(r,a)},yellowFadeOut:function(e,n,t){this.fadeOut(e,n,t,"yellow")},yellowFadeIn:function(e,n){this.fadeIn(e,n,"yellow")},_fade:function(n,t,i,o,u,r){var f,l,c,m,h={node:n,from:{opacity:0},to:{opacity:t},duration:i,easing:e.Easing.easeNone};return u&&(u in g?(f=g[u],c=f.from,m=f.to):a(u)&&2===u.length&&(c=u[0],m=u[1]),h.from[d]=c,h.to[d]=m),e.mix(h,r||{},!0),l=new e.Anim(h),l.on("end",function(){s(o)&&o.call(n)}),l},slideDown:function(n,t){var i,o=this,a=o.get("host"),r=u.getDimensions(a);a.setStyles({height:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0}),a.setStyle("display","block"),n=o._getSpeed(n),i=new e.Anim({node:a,to:{height:r.offsetHeight,paddingTop:r.paddingTop,paddingBottom:r.paddingBottom,marginTop:r.marginTop,marginBottom:r.marginBottom},duration:n,easing:e.Easing.easeOut}),i.on("end",function(){s(t)&&t.call(a)}),o._run(i)},slideUp:function(n,t,i){var o,a=this,r=a.get("host"),g=u.getDimensions(r),d=a._cloneLayout(r,"div");r.replace(d),d.setStyles({height:g.marginTop+g.offsetHeight+g.marginBottom,position:"relative"}).appendChild(r),t=a._getSpeed(t),o=new e.Anim({node:d,to:{height:0},duration:t,easing:e.Easing.easeIn}),o.on("end",function(){r.hide().unwrap(),s(i)&&i.call(r),n&&r.destroy(!0)}),a._run(o)},roll:function(n,t,o){function a(){_||(d=n.item(S%g),f=n.item((S+1)%g),S=(S+1)%g,s()),window.setTimeout(a,o)}function s(){f.setStyle("top",y+1),l.set("node",d).run(),c.set("node",f).run()}function r(){h.setStyles({position:"relative",height:y,overflow:"hidden"}),n.each(function(e,n){e.setStyles({position:"absolute",display:"",top:0===n?0:y+1})})}var g,d,f,l,c,m=this,h=m.get("host"),p=u.getDimensions,y=0,_=!1,S=0;i(n)&&(n=h.all(n)),n&&(g=n.size(),2>g||(n.each(function(e){var n=p(e).offsetHeight;n>y&&(y=n)}),t=m._getSpeed(t),r(),h.on({mouseover:function(){_=!0},mouseout:function(){_=!1}}),window.setTimeout(a,o),l=new e.Anim({node:d,to:{top:-y},duration:t,easing:e.Easing.easeBoth}),c=new e.Anim({node:f,to:{top:0},duration:t,easing:e.Easing.easeBoth})))},isInAnimation:function(){return 0!==this._running},_getSpeed:function(e){var n=r.middle;return i(e)&&r[e]?n=r[e]:o(e)&&(n=e),n/1e3},_cloneLayout:function(e,n){var i;return n=n||e.get("tagName"),i=t.create("<"+n+' class="effect-assistance"></'+n+">"),i.setStyles({height:0,margin:0,border:"none",padding:0,background:"none",overflow:"hidden"}),i},_setPosition:function(e){var n=e.getStyle(f);"static"===n&&e.setStyle(f,"relative")},_run:function(){function e(e,n){e.after("end",function(){n.run()})}var n,t,i,o=this.get("host"),a=arguments.length;if(0!==a){for(t=arguments[0],i=arguments[a-1],n=1;a>n;n++)e(arguments[n-1],arguments[n]);t.on("start",function(){o.fire(l)}),i.on("end",function(){o.fire(c)}),t.run()}}}),e.namespace("mt.plugin").Effect=n},"1.0.0",{requires:["mt-base","mt-uiutil","anim","plugin","node"]});