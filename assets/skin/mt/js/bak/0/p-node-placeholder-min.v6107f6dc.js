M.add("p-node-placeholder",function(e){function t(){this.handler={submit:null},t.superclass.constructor.apply(this,arguments)}var s=e.UA.ie,i=e.Lang.trim,l=e.mt.util,r="data-placeholder-type",a=function(e,t){try{return e.type=t,!0}catch(s){return!1}};t.NAME="placeholderPlugin",t.NS="placeholder",t.ATTRS={placeholder:{valueFn:"_getPlaceholderValue",readOnly:!0}},t.PLACEHOLDER_CLASS="placeholder",e.extend(t,e.Plugin.Base,{initializer:function(){var i,r=this,a=r.get("host");a&&(i=a.ancestor("form")),a instanceof e.Node&&!l.isSupportPlaceholder()&&(r.onHostEvent("focus",r.hide),r.onHostEvent("blur",function(){r.show(!1)}),i&&(r.handler.submit=i.on("submit",function(){r.hide()})),s&&l.addLoadListener(function(){a.get("value")&&a.removeClass(t.PLACEHOLDER_CLASS),r.show(!0)}),r.show(!0))},destructor:function(){this.hide(),this.handler.submit&&this.handler.submit.detach()},show:function(e){var s,i=this.get("host"),l=i.getDOMNode(),n=this.get("placeholder");if(""===i.get("value")||e&&this._isValueEqualPlaceholder()){if(s=i.getAttribute(r))l.type="text";else if("password"===i.get("type")){if(!a(l,"text"))return;i.setAttribute(r,"password")}i.set("value",n),i.addClass(t.PLACEHOLDER_CLASS)}},hide:function(){var e,s=this.get("host");this._isValueEqualPlaceholder()&&(e=s.getAttribute(r),e&&s.set("type",e),this._removePlaceholder(),s.removeClass(t.PLACEHOLDER_CLASS))},_isValueEqualPlaceholder:function(){return this.get("host").get("value")===this.get("placeholder")},_removePlaceholder:function(){var e,t,s=this.get("host"),l=this.get("placeholder"),r=i(s.get("value")),a=l.length,n=r.length-a;if(l===r)return s.set("value",""),void 0;if(0===r.indexOf(l))return s.set("value",r.substring(a)),void 0;if(r.lastIndexOf(l)===n)return s.set("value",r.substring(0,n)),void 0;for(e=1;a-1>e;++e)if(t=r.substring(0,e)+r.substring(e+n),t===l)return s.set("value",r.substring(e,e+n)),void 0},_getPlaceholderValue:function(){return this.get("host").getAttribute("placeholder")}}),e.namespace("mt.plugin").Placeholder=t},"1.0.0",{requires:["mt-base","plugin"]});